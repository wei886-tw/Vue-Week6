import{_ as m,c as n,a as e,F as u,r as p,b,d as f,o as i,t as d}from"./index-CJXK5sQV.js";const _={data(){return{apiUrl:"https://vue3-course-api.hexschool.io",api_path:"wei123",url:"https://vue3-course-api.hexschool.io/v2/api/wei123",allProducts:[],cartProducts:[],cartInfo:{},tempProduct:{},currentCart:{},totalMoney:0}},methods:{getProducts(){this.$http.get(`${this.apiUrl}/api/${this.api_path}/products/all`).then(t=>{this.allProducts=t.data.products})},openModal(t){this.tempProduct=t,this.myModal.show()},getCarts(){this.$http.get(`${this.apiUrl}/v2/api/${this.api_path}/cart`).then(t=>{this.cartProducts=t.data.data.carts,this.cartInfo=t.data.data}).catch(t=>{console.log(t)})},addToCart(t,s=1){const o={product_id:t,qty:s};this.$http.post(`${this.url}/cart`,{data:o}).then(l=>{console.log(l),alert("加入購物車成功"),this.getCarts()}).catch(l=>{console.log(l)})},delCartItem(t){this.$http.delete(`${this.apiUrl}/v2/api/${this.api_path}/cart/${t}`).then(s=>{console.log(s),this.getCarts()}).catch(s=>{console.log(s)})},delAllCartItems(){this.$http.delete(`${this.apiUrl}/v2/api/${this.api_path}/carts`).then(t=>{console.log(t),alert("確定要清空購物車嗎"),this.getCarts()}).catch(t=>{console.log(t)})},setCartItemQty(t,s){this.currentCart=this.cartProducts.find(o=>o.id===t),this.currentCart.qty=Number(s.target.value),this.currentCart.total=this.currentCart.qty*this.currentCart.product.price,console.log("cartInfo",this.cartInfo)},modalAddToCart(t,s){const o={product_id:t,qty:s};this.$http.post(`${this.url}/cart`,{data:o}).then(l=>{console.log(l),alert("加入購物車成功"),this.getCarts()}).catch(l=>{console.log(l)})},countTotal(){this.totalMoney=this.cartProducts.reduce((t,s)=>t+s.total,0),console.log(this.totalMoney)}},mounted(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=t,this.getProducts(),this.getCarts()}},g={class:"container"},y={class:"row"},v={class:"col-12"},C=e("h1",{class:"d-flex justify-content-center my-3"},"購物車列表",-1),x={class:"table align-middle"},$=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"200px"}},"單位/數量"),e("th",null,"單價")])],-1),I=["onClick"],P={class:"d-flex align-items-end"},k=["value","onChange"],w={class:"btn btn-outline-primary btn-sm"},A={key:0,class:"row"},N={class:"col-12"},T={class:"d-flex justify-content-end"},U=f('<div class="row my-5"><div class="col-12 d-flex justify-content-center"><form><div class="mb-3"><label for="exampleInputEmail1" class="form-label">Email</label><input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp"></div><div class="mb-3"><label for="inputName" class="form-label">收件人姓名</label><input type="text" class="form-control" id="inputName"></div><div class="mb-3"><label for="inputTelephone" class="form-label">收件人電話</label><input type="tel" name="phone" class="form-control" id="inputTelephone"></div><div class="mb-3"><label for="inputAddress" class="form-label">收件人地址</label><input type="text" name="address" class="form-control" id="inputAddress"></div><div class="mb-3 d-flex flex-column"><label for="textarea" class="form-label">留言</label><textarea name="textarea" id="textarea" cols="30" style="height:fit-content;" class="form-control border border-1 rounded"></textarea></div><div class="d-flex justify-content-end"><button type="submit" class="btn btn-primary d-flex justify-content-end"> 送出訂單 </button></div></form></div></div>',1);function j(t,s,o,l,h,c){return i(),n("div",g,[e("div",y,[e("div",v,[C,e("table",x,[$,e("tbody",null,[(i(!0),n(u,null,p(h.cartProducts,a=>(i(),n("tr",{key:a.id},[e("td",null,[e("button",{type:"btn",class:"btn btn-outline-danger btn-sm",onClick:r=>c.delCartItem(a.id)}," X ",8,I)]),e("td",null,d(a.product.title),1),e("td",P,[e("select",{name:"",id:"",value:a.qty,style:{height:"31px"},onChange:r=>c.setCartItemQty(a.id,r)},[(i(),n(u,null,p(20,r=>e("option",{key:r},d(r),1)),64))],40,k),e("button",w,d(a.product.unit),1)]),e("td",null,d(a.total),1)]))),128))])])])]),h.cartProducts.length!=0?(i(),n("div",A,[e("div",N,[e("div",T,[e("button",{class:"btn btn-outline-danger",onClick:s[0]||(s[0]=(...a)=>c.delAllCartItems&&c.delAllCartItems(...a))},"清空購物車")])])])):b("",!0),U])}const E=m(_,[["render",j]]);export{E as default};
